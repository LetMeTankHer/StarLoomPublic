import{e as z,r,j as e}from"./index-BH3WP3JE.js";import{FaFilm as S,FaChevronDown as E,FaChevronLeft as Y,FaChevronRight as G,FaPause as H,FaPlay as I,FaRedoAlt as J}from"./index-CLfD_T3x.js";import"./iconBase-JDSg_RpE.js";var K=z();const m=[1,2,.5,.1],X=({animations:l=[],modelMixer:d})=>{const[g,F]=r.useState(!0),[i,A]=r.useState(0),[x,y]=r.useState(!0),[h,O]=r.useState(0),[N,b]=r.useState(0),[c,v]=r.useState(!1),[k,L]=r.useState({top:0,left:0}),[w,C]=r.useState(""),s=r.useRef(null),u=r.useRef(null),p=r.useRef(null),P=r.useRef(),j=t=>{const n=["_in_game_","_entrance_"];for(const o of n){const a=t.indexOf(o);if(a!==-1)return t.slice(a+o.length)}return t},f=t=>{if(!l.length||!d)return;s.current&&s.current.stop();const n=(t+l.length)%l.length,o=l[n],a=d.clipAction(o);a.reset(),a.setEffectiveTimeScale(m[h]),a.play(),s.current=a,A(n),y(!0),b(0)},_=()=>{s.current&&(s.current.paused=x,y(!x))},D=()=>{const t=(h+1)%m.length;O(t),s.current&&s.current.setEffectiveTimeScale(m[t])},$=t=>{const n=parseFloat(t.target.value);b(n);const o=s.current?.getClip();o&&(s.current.time=n/100*o.duration)},B=()=>f(i-1),T=()=>f(i+1);r.useEffect(()=>(P.current=setInterval(()=>{const t=s.current;if(!t?.getClip())return;const n=t.getClip();b(t.time/n.duration*100)},50),()=>clearInterval(P.current)),[]),r.useEffect(()=>{l.length&&d&&f(0)},[l,d]);const W=()=>v(t=>!t);r.useEffect(()=>{if(c&&p.current&&u.current){const t=p.current.getBoundingClientRect(),n=u.current.offsetWidth,o=t.left+t.width/2-n/2,a=t.bottom+window.scrollY+6;L({top:a,left:Math.max(o,5)})}},[c]),r.useEffect(()=>{const t=n=>{c&&u.current&&!u.current.contains(n.target)&&!p.current.contains(n.target)&&v(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[c]);const R=l.filter(t=>j(t.name).toLowerCase().includes(w.toLowerCase())),q=j(l[i]?.name||"Idle");return e.jsxs("div",{className:"panel flex flex-col border-b-2 border-text-dull w-full relative select-none",children:[e.jsxs("div",{className:"panel-header flex items-center justify-between cursor-pointer py-2",onClick:()=>F(!g),children:[e.jsxs("div",{className:"flex items-center gap-2 text-text font-semibold",children:[e.jsx(S,{})," ",e.jsx("span",{children:"Animations"})]}),e.jsx(E,{className:`text-text-dull transition-transform duration-200 ${g?"rotate-180":""}`})]}),g&&e.jsxs("div",{className:"flex flex-col gap-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:B,title:"Previous Animation",className:"w-10 h-10 flex justify-center text-text items-center rounded-lg border border-text-dull bg-background hover:bg-background/70 active:scale-95 transition",children:e.jsx(Y,{})}),e.jsxs("button",{ref:p,onClick:W,title:"Choose Animation",className:"flex-1 flex items-center justify-center gap-2 rounded-lg border border-text-dull bg-background hover:bg-background/70 active:scale-95 transition h-10 text-text",children:[e.jsx(S,{}),e.jsx("span",{className:"truncate max-w-[150px]",children:q}),e.jsx(E,{className:`transition-transform duration-200 ${c?"rotate-180":""}`})]}),e.jsx("button",{onClick:T,title:"Next Animation",className:"w-10 h-10 flex justify-center items-center rounded-lg border border-text-dull text-text bg-background hover:bg-background/70 active:scale-95 transition",children:e.jsx(G,{})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:_,title:x?"Pause":"Play",className:"w-10 h-10 flex justify-center items-center rounded-lg border border-text-dull text-text bg-background hover:bg-background/70 active:scale-95 transition",children:x?e.jsx(H,{}):e.jsx(I,{})}),e.jsxs("div",{className:"relative flex-1 h-2 bg-gray-700 rounded overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 h-full bg-primary transition-[width] duration-50",style:{width:`${N}%`}}),e.jsx("input",{type:"range",min:"0",max:"100",value:N,onChange:$,className:"absolute top-0 left-0 w-full h-full opacity-0 cursor-pointer"})]}),e.jsxs("button",{onClick:D,title:"Change Speed",className:"px-3 py-1 border border-text-dull rounded-lg bg-background hover:bg-background/70 text-text active:scale-95 transition h-10",children:[m[h],"x"]})]})]}),c&&K.createPortal(e.jsxs("div",{ref:u,className:"absolute z-50 flex flex-col rounded-xl shadow-lg bg-body border border-text-dull p-2 min-w-[280px] max-h-80 overflow-hidden animate-fadeIn",style:{position:"absolute",top:k.top,left:k.left},children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 border-b border-text-dull",children:[e.jsx("input",{type:"text",placeholder:"Search animation...",className:"flex-1 px-2 py-1 rounded bg-background text-text outline-none",value:w,onChange:t=>C(t.target.value)}),e.jsx(J,{className:"text-text-dull cursor-pointer hover:text-primary",onClick:()=>C("")})]}),e.jsxs("div",{className:"overflow-y-auto flex-1 p-1 scrollbar-thin scrollbar-thumb-primary scrollbar-track-background",children:[R.map((t,n)=>e.jsxs("button",{onClick:()=>{f(n),v(!1)},className:`w-full text-text text-left px-3 py-2 rounded flex items-center justify-between ${n===i?"bg-primary/30 text-primary":"hover:bg-background"}`,children:[e.jsx("span",{className:"truncate",children:j(t.name)}),n===i&&e.jsx(I,{className:"text-primary"})]},n)),R.length===0&&e.jsx("div",{className:"text-center text-text-dull py-2 text-sm",children:"No animations found"})]})]}),document.body)]})};export{X as default};
