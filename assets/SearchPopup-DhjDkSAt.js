import{r as a,j as e,L as g}from"./index-3F8ASdVJ.js";import{FaSearch as y,FaTimes as v}from"./index-nER0fkIN.js";import"./iconBase-DFSyAiy9.js";const S=()=>{const[p,c]=a.useState(!1),[o,b]=a.useState(""),[d,j]=a.useState([]),[u,m]=a.useState([]),[x,h]=a.useState(!1),n="/StarLoomPublic/",l=a.useRef({}),i=a.useRef(null);return a.useEffect(()=>{(async()=>{try{const r=await(await fetch(`${n}data/heroes_index.json`)).json();j(r.heroes||[])}catch(s){console.error("Failed to fetch heroes index:",s)}})()},[n]),a.useEffect(()=>{i.current&&clearTimeout(i.current),i.current=setTimeout(async()=>{if(!o)return m([]);h(!0);const t=d.filter(r=>r.name.toLowerCase().startsWith(o.toLowerCase())),s=await Promise.all(t.map(async r=>{if(l.current[r.id])return l.current[r.id];try{const f=await(await fetch(`${n}data/heroes/${r.details_file}`)).json();return l.current[r.id]=f,f}catch{return null}}));m(s.filter(Boolean)),h(!1)},300)},[o,d,n]),e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>c(!0),className:"p-1 rounded transition hover:text-primary","aria-label":"Open search",children:e.jsx(y,{})}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex justify-center items-start pt-20 z-50",onClick:()=>c(!1),role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"bg-background p-4 rounded shadow-lg w-96",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-2 border-b border-muted pb-2 mb-2",children:[e.jsx("input",{type:"text",value:o,onChange:t=>b(t.target.value),placeholder:"Search by heroes or commanders...",className:"flex-1 p-2 bg-transparent focus:outline-none",autoFocus:!0}),e.jsx("button",{onClick:()=>c(!1),className:"p-1 hover:text-primary","aria-label":"Close search",children:e.jsx(v,{})})]}),x&&e.jsx("p",{className:"mt-2",children:"Loading..."}),o&&!x&&u.length===0&&e.jsx("p",{className:"mt-2 text-center text-muted",children:"No heroes found."}),e.jsx("div",{className:"mt-2 flex flex-col gap-2 max-h-80 overflow-y-auto scrollbar-thin scrollbar-thumb-primary scrollbar-track-background",children:u.map(t=>Object.values(t.skins||{}).map(s=>e.jsxs(g,{to:`/model_viewer/${t.id}/${s.skin_id}&model_type=in_game`,className:"flex items-center gap-3 p-2 rounded-lg hover:bg-body hover:shadow-lg transition",onClick:()=>c(!1),children:[e.jsx("img",{src:`${n}${s.avatars?.default||""}`,alt:t.name,className:"w-12 h-12 rounded-full object-cover border border-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-text",children:t.name}),e.jsx("p",{className:"text-sm text-muted",children:s.name})]})]},`${t.id}-${s.skin_id}`)))})]})})]})};export{S as default};
